--register map regions
regions = {}
<unitEvent name="buildscan">
scan = regions[name]
x = scan.x
y = scan.y
w = scan.w
h = scan.h
i=1
while buildings[i] ~= nil do
check = buildings.location
checkx = location.x
checky = location.y
if checkx<w and checkx>x then
if checky<h and checky>y then
for i=1, 5 do
createUnit('daemon', 1, {x, y})
end
end
i=i+1
end
</unitEvent>


name = 1
for i=1, 32 do
y=(i-1)*16
h=y+16
for n=1, 32 do
x=(n-1)*32
w=x+32
registerRegion(name, {x, y, w, h})
table.insert(regions, {x, y, w, h})
setFactionTrigger(1, 'region=name', 'buildscan', name)
name=name+1
end
end



<timer name="createanddestroy">
buildingid = lastCreatedUnit()
buildingsSize = table.getn(buildings)
buildingcompare = buildings[buildingsSize]
if buildingid ~= buildingcompare then
buildingcheck = lastCreatedUnitName()
if buildingcheck=='peasant_hut' or buildingcheck=='wood_cutter_shed' 
or buildingcheck=='stone_cutter_shed' or buildingcheck=='ore_ mine' 
or buildingcheck=='barracks' or buildingcheck=='castle' 
or buildingcheck=='blacksmith' or buildingcheck=='magesmith_guild' 
or buildingcheck=='construction_guild' or buildingcheck=='alchemists_guild' 
or buildingcheck=='achur_mage_guild' or buildingcheck=='marketplace' 
or buildingcheck=='anima_ward' or buildingcheck=='anima_source' 
or buildingcheck=='animators_guild' or buildingcheck=='archer_tower' 
or buildingcheck=='stable' or buildingcheck=='ballista' 
then 
location = unitPosition(buildingid)
table.insert(buildings, buildingid, location)
end
end
buildingkill = lastDeadUnitName()
if buildingkill ~= nil then						
if buildingkill=='peasant_hut' or buildingkill=='wood_cutter_shed' 
or buildingkill=='stone_cutter_shed' or buildingkill=='ore_ mine' 
or buildingkill=='barracks' or buildingkill=='castle' 
or buildingkill=='blacksmith' or buildingkill=='magesmith_guild' 
or buildingkill=='construction_guild' or buildingkill=='alchemists_guild' 
or buildingkill=='achur_mage_guild' or buildingkill=='marketplace' 
or buildingkill=='anima_ward' or buildingkill=='anima_source' 
or buildingkill=='animators_guild' or buildingkill=='archer_tower' 
or buildingkill=='stable' or buildingkill=='ballista' 
then
expunge = 0
while buildings[expunge] ~= lastDeadUnit() do
expunge=expunge+1
table.remove(buildings,expunge)	
end


end
end	
		
</timer>	

setTimer('createanddestroy', 'game', 1, true)
















